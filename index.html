<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diagnóstico Financeiro - Veritus Capital</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">

  <div class="max-w-xl mx-auto mt-10 bg-white p-8 rounded-2xl shadow-lg">
    <h1 class="text-2xl font-bold mb-6 text-center text-indigo-600">Diagnóstico Financeiro</h1>

    <form id="diagnosticoForm" class="space-y-6">
      <!-- Etapa 1 -->
      <div class="form-step block">
        <div>
          <label class="block mb-1 font-medium">Nome completo *</label>
          <input type="text" name="nome" required class="w-full border p-2 rounded-md" />
        </div>
        <div>
          <label class="block mb-1 font-medium">E-mail *</label>
          <input type="email" name="email" required class="w-full border p-2 rounded-md" />
        </div>
        <div>
          <label class="block mb-1 font-medium">Telefone *</label>
          <input type="tel" name="telefone" required class="w-full border p-2 rounded-md" />
        </div>
      </div>

      <!-- Etapa 2 -->
      <div class="form-step hidden">
        <label class="block mb-1 font-medium">Quais dessas dores você enfrenta atualmente? *</label>
        <textarea name="dores" required rows="5" class="w-full border p-2 rounded-md"></textarea>
      </div>

      <!-- Etapa 3 -->
      <div class="form-step hidden">
        <label class="block mb-1 font-medium">Quais são seus principais objetivos financeiros? *</label>
        <textarea name="metas" required rows="5" class="w-full border p-2 rounded-md"></textarea>
      </div>

      <!-- Etapa 4 -->
      <div class="form-step hidden">
        <label class="block mb-1 font-medium">Deseja nos contar algo mais?</label>
        <textarea name="comentario" rows="4" class="w-full border p-2 rounded-md"></textarea>
      </div>

      <!-- Botões de navegação -->
      <div class="flex justify-between">
        <button type="button" id="voltarBtn" class="bg-gray-300 px-4 py-2 rounded-md text-sm hidden">Voltar</button>
        <button type="button" id="proximoBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-md text-sm">Próximo</button>
        <button type="submit" id="enviarBtn" class="bg-green-600 text-white px-4 py-2 rounded-md text-sm hidden">Enviar</button>
      </div>
    </form>

    <div id="mensagem" class="text-center mt-4 font-medium"></div>
  </div>

  <script>
    const form = document.getElementById('diagnosticoForm');
    const steps = document.querySelectorAll('.form-step');
    const btnProximo = document.getElementById('proximoBtn');
    const btnVoltar = document.getElementById('voltarBtn');
    const btnEnviar = document.getElementById('enviarBtn');
    const mensagem = document.getElementById('mensagem');
    let currentStep = 0;

    function mostrarEtapa(index) {
      steps.forEach((step, i) => {
        step.classList.toggle('hidden', i !== index);
      });
      btnVoltar.classList.toggle('hidden', index === 0);
      btnProximo.classList.toggle('hidden', index === steps.length - 1);
      btnEnviar.classList.toggle('hidden', index !== steps.length - 1);
    }

    btnProximo.addEventListener('click', () => {
      const inputs = steps[currentStep].querySelectorAll('input, textarea');
      for (const input of inputs) {
        if (!input.checkValidity()) {
          input.reportValidity();
          return;
        }
      }
      currentStep++;
      mostrarEtapa(currentStep);
    });

    btnVoltar.addEventListener('click', () => {
      currentStep--;
      mostrarEtapa(currentStep);
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const dados = Object.fromEntries(new FormData(form).entries());

      // Substitua pela sua URL do Google Apps Script
      const endpoint = "https://script.google.com/macros/s/AKfycbzzBh24qqPxFNSixnnZcXHFNogM89glRXHQeZeh_VFx-Lcuv5q1l2kSe97JCVlJHFf5Ww/exec";

      try {
        const response = await fetch(endpoint, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(dados)
        });

        form.reset();
        currentStep = 0;
        mostrarEtapa(currentStep);
        mensagem.textContent = "Diagnóstico enviado com sucesso!";
        mensagem.className = "text-green-600";
      } catch (error) {
        mensagem.textContent = "Erro ao enviar. Tente novamente.";
        mensagem.className = "text-red-600";
      }
    });

    mostrarEtapa(currentStep);
  </script>
</body>
</html>
